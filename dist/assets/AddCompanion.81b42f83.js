import{i as F,j as H,r as k,m as $,k as J,n as P,I as L,b as _,o as S,c as q,d as e,e as l,q as T,w as t,a0 as I,y as j,g as K,T as f,H as D,h as b,x as c}from"./index.7b837cba.js";import{c as Q,a as h,d as W,F as X,b as v,E as g}from"./vee-validate.esm.8f393282.js";const Y="/assets/companion_left.3e2f568a.png",Z="/assets/companion_right.4ac626cb.png",ee={key:0,src:Y,style:{position:"fixed",left:"0px",bottom:"0px",width:"20%"}},ae={key:1,src:Z,style:{position:"fixed",right:"0px",bottom:"0px",width:"20%"}},te=b("h2",null,"\u041D\u0430\u0439\u0442\u0438 \u043F\u043E\u043F\u0443\u0442\u0447\u0438\u043A\u0430",-1),oe=c(" \u041C\u043E\u0439 \u043F\u043E\u043B "),le=c("\u041C\u0443\u0436\u0447\u0438\u043D\u0430"),ne=c("\u0416\u0435\u043D\u0449\u0438\u043D\u0430"),se=b("label",null,"\u041C\u043E\u0439 \u0432\u043E\u0437\u0440\u0430\u0441\u0442",-1),de=b("label",null,"\u0418\u043C\u044F",-1),ue=b("label",null,"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",-1),ie=b("label",null,"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",-1),re=b("label",null,"\u042D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u0430\u044F \u043F\u043E\u0447\u0442\u0430",-1),me=c(" \u041F\u043E\u043B \u043F\u043E\u043F\u0443\u0442\u0447\u0438\u043A\u0430 "),ce=c("\u041C\u0443\u0436\u0447\u0438\u043D\u0430"),pe=c("\u0416\u0435\u043D\u0449\u0438\u043D\u0430"),_e=c("\u041D\u0435 \u0432\u0430\u0436\u043D\u043E"),fe=c(" \u041F\u0435\u0440\u0438\u043E\u0434 "),ve=b("label",null,"\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",-1),ge=c(" \u041C\u0435\u0441\u0442\u043E \u0441\u0442\u0430\u0440\u0442\u0430 "),he=c(" \u041F\u043E\u0436\u0435\u043B\u0430\u043D\u0438\u044F "),be={class:"d-flex justify-center",style:{width:"100%"}},xe=c("\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C "),ke={__name:"AddCompanion",setup(ye){let N=F(H).smaller("md"),U=k([]),y=k(""),G=$();const w=J(),M="/companions";let i=k(null);const n=P({name:"",surname:"",email:"",phone:"",start:"",end:"",age:"",companionGender:"\u041D\u0435 \u0432\u0430\u0436\u043D\u043E",gender:"\u041C\u0443\u0436\u0447\u0438\u043D\u0430",type:"\u041B\u044E\u0431\u043E\u0439",direction:"",description:"",startLocation:{}});function R(){I.createCompanion(n).then(d=>{const o=d.data._id;w.updateUser({email:w.user.email,$push:{createdCompanions:o}}).then(r=>{w.user=r.data,j.config({top:"90vh",duration:2}),j.success({content:"\u041F\u043E\u043F\u0443\u0442\u0447\u0438\u043A \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D!"}).then(()=>{G.push("/companions"),Object.assign(n,{name:"",surname:"",email:"",phone:"",start:"",end:"",age:"",gender:"Male",companionGender:"\u041D\u0435 \u0432\u0430\u0436\u043D\u043E",direction:"",description:""}),i.value=null})}).catch(r=>{console.log(r)})})}L(i,()=>{if(i.value){let d=new Date(i.value[0]);d.setHours(0),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0);let o=new Date(i.value[1]);o.setHours(23),o.setMinutes(59),o.setSeconds(59),o.setMilliseconds(999),n.start=i?Number(Date.parse(d.toString())):"",n.end=i?Number(Date.parse(o.toString())):""}});function A(d){for(let o of U.value)o.value==d&&(n.startLocation=o.location)}L(y,async(d,o)=>{if(d.trim().length>2&&d.length>o.length){var r="https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address",V={method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Token 93a66149524b08b26a740de84a773157ace019a0"},body:JSON.stringify({query:d,count:5,from_bound:{value:"city"},to_bound:{value:"settlement"}})};let u=await fetch(r,V);try{let p=JSON.parse(await u.text()).suggestions;U.value=[];for(let m of p){let x={value:m.value,location:{name:m.value,shortName:"",type:"Point",coordinates:[m.data.geo_lon,m.data.geo_lat]}};m.data.settlement?x.location.shortName=m.data.settlement:m.data.city?x.location.shortName=m.data.city:x.location.shortName=m.value,U.value.push(x)}}catch(p){console.log(p)}}});const B=Q({age:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),name:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),surname:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),email:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435").email("\u043D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u0444\u043E\u0440\u043C\u0430\u0442"),phone:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),date:W().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),direction:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),description:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435"),startLocation:h().required("\u0437\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u043E\u043B\u0435")});return(d,o)=>{const r=_("a-radio"),V=_("a-radio-group"),u=_("a-col"),p=_("a-input"),m=_("a-range-picker"),x=_("a-auto-complete"),O=_("a-textarea"),z=_("a-button"),C=_("a-row");return S(),q("div",null,[e(K,{backRoute:M}),l(N)?T("",!0):(S(),q("img",ee)),l(N)?T("",!0):(S(),q("img",ae)),e(l(X),{"validation-schema":l(B),onSubmit:R},{default:t(({meta:E})=>[e(C,{type:"flex",justify:"center"},{default:t(()=>[e(u,{xs:22,lg:12},{default:t(()=>[te,e(C,{gutter:[8,8]},{default:t(()=>[e(u,{xs:12,class:"d-flex align-center",style:{"flex-wrap":"wrap"}},{default:t(()=>[oe,e(V,{value:n.gender,"onUpdate:value":o[0]||(o[0]=a=>n.gender=a),name:"radioGroup",style:{width:"-webkit-fill-available"}},{default:t(()=>[e(r,{value:"\u041C\u0443\u0436\u0447\u0438\u043D\u0430"},{default:t(()=>[le]),_:1}),e(r,{value:"\u0416\u0435\u043D\u0449\u0438\u043D\u0430"},{default:t(()=>[ne]),_:1})]),_:1},8,["value"])]),_:1}),e(u,{span:12},{default:t(()=>[e(l(v),{name:"age",modelValue:n.age,"onUpdate:modelValue":o[1]||(o[1]=a=>n.age=a)},{default:t(({value:a,handleChange:s})=>[se,e(p,{"onUpdate:value":s,value:a,type:"number",min:0},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"age",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24,md:12},{default:t(()=>[e(l(v),{name:"name",modelValue:n.name,"onUpdate:modelValue":o[2]||(o[2]=a=>n.name=a)},{default:t(({value:a,handleChange:s})=>[de,e(p,{"onUpdate:value":s,value:a},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"name",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24,md:12},{default:t(()=>[e(l(v),{name:"surname",modelValue:n.surname,"onUpdate:modelValue":o[3]||(o[3]=a=>n.surname=a)},{default:t(({value:a,handleChange:s})=>[ue,e(p,{"onUpdate:value":s,value:a},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"surname",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24,md:12},{default:t(()=>[e(l(v),{name:"phone",modelValue:n.phone,"onUpdate:modelValue":o[4]||(o[4]=a=>n.phone=a)},{default:t(({value:a,handleChange:s})=>[ie,e(p,{"onUpdate:value":s,value:a},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"phone",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24,md:12},{default:t(()=>[e(l(v),{name:"email",modelValue:n.email,"onUpdate:modelValue":o[5]||(o[5]=a=>n.email=a)},{default:t(({value:a,handleChange:s})=>[re,e(p,{"onUpdate:value":s,value:a},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"email",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24,md:12,class:"d-flex align-center",style:{"flex-wrap":"wrap"}},{default:t(()=>[me,e(V,{value:n.companionGender,"onUpdate:value":o[6]||(o[6]=a=>n.companionGender=a),name:"radioGroup",style:{width:"-webkit-fill-available"}},{default:t(()=>[e(r,{value:"\u041C\u0443\u0436\u0447\u0438\u043D\u0430"},{default:t(()=>[ce]),_:1}),e(r,{value:"\u0416\u0435\u043D\u0449\u0438\u043D\u0430"},{default:t(()=>[pe]),_:1}),e(r,{value:"\u041D\u0435 \u0432\u0430\u0436\u043D\u043E"},{default:t(()=>[_e]),_:1})]),_:1},8,["value"])]),_:1}),e(u,{xs:24,md:12},{default:t(()=>[e(l(v),{name:"date",modelValue:l(i),"onUpdate:modelValue":o[7]||(o[7]=a=>D(i)?i.value=a:i=a)},{default:t(({value:a,handleChange:s})=>[fe,e(m,{"onUpdate:value":s,value:a,style:{width:"100%"}},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"date",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24},{default:t(()=>[e(l(v),{name:"direction",modelValue:n.direction,"onUpdate:modelValue":o[8]||(o[8]=a=>n.direction=a)},{default:t(({value:a,handleChange:s})=>[ve,e(p,{"onUpdate:value":s,value:a,"show-count":"",maxlength:30},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"direction",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24},{default:t(()=>[e(l(v),{name:"startLocation",modelValue:l(y),"onUpdate:modelValue":o[9]||(o[9]=a=>D(y)?y.value=a:y=a)},{default:t(({value:a,handleChange:s})=>[ge,e(x,{value:a,"onUpdate:value":s,style:{width:"100%"},options:l(U),placeholder:"\u0413\u043B\u0430\u0437\u043E\u0432",onSelect:A},null,8,["value","onUpdate:value","options"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"startLocation",class:"error-message"})]),_:1})]),_:1}),e(u,{xs:24},{default:t(()=>[e(l(v),{name:"description",modelValue:n.description,"onUpdate:modelValue":o[10]||(o[10]=a=>n.description=a)},{default:t(({value:a,handleChange:s})=>[he,e(O,{"onUpdate:value":s,value:a,"autoSizeshow-count":"",maxlength:60},null,8,["onUpdate:value","value"])]),_:1},8,["modelValue"]),e(f,{name:"fade"},{default:t(()=>[e(l(g),{name:"description",class:"error-message"})]),_:1})]),_:1}),b("div",be,[e(z,{disabled:!E.valid,type:"primary",class:"lets_go_btn",size:"large","html-type":"submit"},{default:t(()=>[xe]),_:2},1032,["disabled"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["validation-schema"])])}}};export{ke as default};
